<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />

    <title>{{ title }}</title>
    <meta content="" name="description" />
    <meta content="" name="keywords" />

    <link href="{{ url_for('static',filename='unduhan.png') }}" rel="icon" />
    <link href="{{ url_for('static',filename='assets/img/apple-touch-icon.png') }}" rel="apple-touch-icon" />

    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Jost:300,300i,400,400i,500,500i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i" rel="stylesheet" />

    <link href="{{ url_for('static',filename='assets/vendor/aos/aos.css') }}" rel="stylesheet" />
    <link href="{{ url_for('static',filename='assets/vendor/bootstrap/css/bootstrap.min.css') }}" rel="stylesheet" />
    <link href="{{ url_for('static',filename='assets/vendor/bootstrap-icons/bootstrap-icons.css') }}" rel="stylesheet" />
    <link href="{{ url_for('static',filename='assets/vendor/boxicons/css/boxicons.min.css') }}" rel="stylesheet" />
    <link href="{{ url_for('static',filename='assets/vendor/glightbox/css/glightbox.min.css') }}" rel="stylesheet" />
    <link href="{{ url_for('static',filename='assets/vendor/remixicon/remixicon.css') }}" rel="stylesheet" />
    <link href="{{ url_for('static',filename='assets/vendor/swiper/swiper-bundle.min.css') }}" rel="stylesheet" />

    <link href="{{ url_for('static',filename='assets/css/style.css') }}" rel="stylesheet" />
</head>

<body>
    <!-- ======= Header ======= -->
    <header id="header" class="fixed-top" style="background: rgba(40, 58, 90, 0.9)">
        <div class="container d-flex align-items-center">
            <h1 class="logo me-auto"><a href="index.html">WXP</a></h1>

            <nav id="navbar" class="navbar">
                <ul>
                    <li><a class="nav-link scrollto" href="/">Home</a></li>
                    <li><a class="nav-link scrollto" href="/">About</a></li>
                    <li><a class="nav-link scrollto" href="/">Team</a></li>
                    <li><a class="nav-link scrollto active" href="/calculate">Calculate</a></li>
                </ul>
                <i class="bi bi-list mobile-nav-toggle"></i>
            </nav>
        </div>
    </header>
    <!-- End Header -->

    <!-- ======= Hero Section ======= -->

    <main id="main">
        <!-- ======= Breadcrumbs ======= -->
        <section id="breadcrumbs" class="breadcrumbs">
            <div class="container">
                <ol>
                    <li><a href="/">Home</a></li>
                    <li>Result</li>
                </ol>
            </div>
        </section>
        <!-- End Breadcrumbs -->
        <section id="team" class="team section-bg">
            <div class="container" data-aos="fade-up">
                <div class="section-title">
                    <h2>Hasil Perhitungan IPK</h2>
                    <p>Penghitungan Indeks Prestasi Kumulatif (IPK) mahasiswa teknik komputer selama periode akademik tertentu.</p>
                </div>

                <div class="row">
                    <div data-aos="zoom-in" data-aos-delay="100">
                        <div class="member d-flex align-items-start">
                            <div class="pic">
                                <img src="assets/img/team/team-1.jpg" class="img-fluid" alt="" />
                            </div>
                            <div class="member-info">
                                <h4>Nama: {{ data[0].nama }}</h4>
                                <span>Nim: {{ data[0].nim }}</span>
                                <p>Semester: {{ data[0].semester }}</p>
                                {% if data[0].konsentrasi %}
                                <p>Konsentrasi: {{ data[0].konsentrasi }}</p>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <!-- ======= About Us Section ======= -->
        <section id="about" class="about">
            <div class="container" data-aos="fade-up">
                <h2>Mata Kuliah{{ " : " + data[0].Konsentrasi if data[0].Konsentrasi else " " }}</h2>
                <!-- Result -->
                <ol class="list-group list-group-numbered">
                    {{data[1]}}
                    {% for key, value in data[1].items() %}
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        <div class="ms-2 me-auto">
                            <span>{{ key.replace('_', ' ') }}</span>
                        </div>
                        <span class="badge text-bg-primary rounded-pill text-uppercase fs-4" data-value="{{ value }}">{{ value }}</span>
                    </li>
                    {% endfor %}
                </ol>
                <!-- End Result -->
            </div>

            <!-- Tambahkan elemen untuk menampilkan hasil perhitungan IPK -->
            <div class="container mt-5" data-aos="fade-up">
                <h2>Hasil Perhitungan IPK</h2>
                <table>
                    <tr>
                      <td>Total SKS</td>
                      <td>:</td>
                      <td>{{ data[2]['total_sks'] }}</td>
                    </tr>
                    <tr>
                      <td>Total IPK</td>
                      <td>:</td>
                      <td>{{ data[2]['total_ipk'] }}</td>
                    </tr>
                    <tr>
                      <td>Rata-Rata</td>
                      <td>:</td>
                      <td>{{ data[2]['rata_rata'] }}</td>
                    </tr>
                  </table>
            </div>
            
        </section>
        <!-- End About Us Section -->
    </main>
    <!-- End #main -->

    <div id="preloader"></div>
    <a href="#" class="back-to-top d-flex align-items-center justify-content-center"><i class="bi bi-arrow-up-short"></i></a>

    <!-- Vendor JS Files -->
    <script src="{{ url_for('static',filename='assets/vendor/aos/aos.js') }}"></script>
    <script src="{{ url_for('static',filename='assets/vendor/bootstrap/js/bootstrap.bundle.min.js') }}"></script>
    <script src="{{ url_for('static',filename='assets/vendor/glightbox/js/glightbox.min.js') }}"></script>
    <script src="{{ url_for('static',filename='assets/vendor/isotope-layout/isotope.pkgd.min.js') }}"></script>
    <script src="{{ url_for('static',filename='assets/vendor/swiper/swiper-bundle.min.js') }}"></script>
    <script src="{{ url_for('static',filename='assets/vendor/waypoints/noframework.waypoints.js') }}"></script>
    <script src="{{ url_for('static',filename='assets/vendor/php-email-form/validate.js') }}"></script>

    <!-- Template Main JS File -->
    <script src="{{ url_for('static',filename='assets/js/main.js') }}"></script>
    <script src="{{ url_for('static',filename='assets/js/calculate.js') }}"></script>

    <script>
        // Fungsi untuk mengonversi nilai huruf menjadi IPK
        function nilaiKeIPK(nilai) {
            if (nilai === 'a') {
                return 4;
            } else if (nilai === 'b') {
                return 3;
            } else if (nilai === 'c') {
                return 2;
            } else if (nilai === 'd') {
                return 1;
            } else if (nilai === 'e') {
                return 0;
            } else {
                return 0; // Nilai tidak valid
            }
        }

        // Mendapatkan semua elemen yang memuat nilai IPK
        var nilaiIPKs = document.querySelectorAll('.list-group-item span');

        // Menghitung total IPK
        var totalIPK = 0;
        nilaiIPKs.forEach(function(nilaiIPK) {
            var nilai = nilaiIPK.getAttribute('data-value');
            totalIPK += nilaiKeIPK(nilai);
        });

        // Menghitung rata-rata IPK
        var jumlahMataKuliah = nilaiIPKs.length;
        var rataRataIPK = totalIPK / jumlahMataKuliah;

        // Menampilkan total IPK dan rata-rata IPK
        var totalIPKElement = document.createElement('span');
        totalIPKElement.textContent = totalIPK.toFixed(2);
        document.getElementById('total_ipk').appendChild(totalIPKElement);

        var rataRataIPKElement = document.createElement('span');
        rataRataIPKElement.textContent = rataRataIPK.toFixed(2);
        document.getElementById('rata_rata_ipk').appendChild(rataRataIPKElement);
    </script>
</body>
</html>
